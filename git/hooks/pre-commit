#!/usr/bin/env python3
"""Pre-commit hook to detect VS Code credential helper in .gitconfig"""

import re
import sys
from pathlib import Path

def main():
    gitconfig_path = Path("git/.gitconfig")
    
    if not gitconfig_path.exists():
        return 0
    
    content = gitconfig_path.read_text()
    
    # Check for VS Code credential helper line
    vscode_pattern = r'^\s*helper = ".*vscode-server.*git-credential-helper.*$'
    
    if re.search(vscode_pattern, content, flags=re.MULTILINE):
        print("‚ùå ERROR: VS Code credential helper detected in git/.gitconfig")
        print("   This should not be committed to the repository.")
        print("   Please remove the line containing 'vscode-server.*git-credential-helper'")
        print("   and ensure your VS Code settings prevent it from being added again.")
        return 1  # Fail the commit
    
    return 0

if __name__ == "__main__":
    sys.exit(main())
